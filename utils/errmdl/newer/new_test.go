package newer

import (
	"fmt"
	"testing"
	"adscodex/oligo/short"
)

// Agilent Regular
var ins163 = []float64 { 1.932599706447216e-05, 1.907465006239047e-05, 1.796576622967714e-05, 4.0234001730282e-05, }
var del163 = []float64 { 0.0013525333328562668, 0.0012476088964652103, 0.0010396820889931337, 0.000963501769685728, }
var sub163 = [][]float64 {
	{ 0.9984963967692717, 0.0010562855382136996, 0.00020790967783404686, 0.00023940801468055206,  },
	{ 0.000425773749226369, 0.9991537151951869, 0.00020276051846823, 0.0002177505371184935,  },
	{ 0.0007387676794934492, 0.00039468395781264913, 0.9985645515672744, 0.00030199679541947536,  },
	{ 0.00021307661255605634, 0.0012931798776384025, 0.00020838602177673717, 0.9982853574880288,  },
}

// Agilent HiFi
var ins165 = []float64 { 4.403698131076149e-05, 2.6212501802815333e-05, 2.926767698912052e-05, 7.256516148030716e-05, }
var del165 = []float64 { 0.0006892946500215952, 0.000584897462448752, 0.0005657541593176433, 0.0005124848696955377, }
var sub165 = [][]float64 {
	{ 0.9987276144174138, 0.000818229475771005, 0.00019609499909436324, 0.00025806110772090925,  },
	{ 0.0003704453453594607, 0.9992087823325114, 0.00021030220544239006, 0.00021047011668671566,  },
	{ 0.0005570297030248491, 0.0003686210440884982, 0.9988293102868337, 0.0002450389660528837,  },
	{ 0.00030570062071379016, 0.0009591949753494968, 0.00016895939881014508, 0.9985661450051265,  },
}

// Minion (pdist 8)
var insont = []float64 { 0.003014448720290026, 0.0038674396195582023, 0.002703262547570003, 0.00318277124022496, }
var delont = []float64 { 0.01118331719843745, 0.011193913591791711, 0.012756681443547793, 0.008576304181293657, }
var subont = [][]float64 {
	{ 0.9762083256164475, 0.005382687831843868, 0.004329306256950532, 0.014079680294758009,  },
	{ 0.0046185665595256135, 0.9737140657964496, 0.017699775627075656, 0.003967592016949176,  },
	{ 0.005256965762057342, 0.02736937814538019, 0.9643150540273302, 0.0030586020652322325,  },
	{ 0.017730218182198516, 0.0054727140356602005, 0.0028445746902455125, 0.9739524930918958,  },
}

func TestGenErrors(t *testing.T) {
	em := New(insont, delont, subont)

	errs := em.SortedErrors(short.FromString1("ACTGACTG"), 0.000001)
	for i := 0; i < len(errs); i++ {
		e := &errs[i]
		fmt.Printf("%v\t%v\n", e.Ol, e.Prob)
	}
}
